<section class="container-fluid my-5">
  <h3 class="text-center fw-semibold text-primary mb-4">Popular Products</h3>

  <h2 class="fw-bold text-dark mb-2">{{ categoryName }}</h2>
  <!-- Search Box -->
  <div class="d-flex justify-content-center mb-4">
    <input
    type="search"
    class="form-control w-50 rounded-pill shadow-sm px-4"
    placeholder="Search for products..."
    [(ngModel)]="searchTerm"
    />
  </div>


  <div class="row">
    <!-- Filter Sidebar -->
    <div class="col-md-3 mb-4">
      <div class="card shadow-sm p-4 bg-white rounded-4 border border-light-subtle">
        <h5 class="fw-bold text-secondary mb-4">Filters</h5>

        <!-- Size Filter -->
        <div class="mb-3">
          <label class="form-label text-muted">Size</label>
          <select class="form-select rounded-pill" [(ngModel)]="selectedSize" (change)="applyFilters()">
            <option value="">All</option>
            <option value="S">S</option>
            <option value="M">M</option>
            <option value="L">L</option>
          </select>
        </div>

        <!-- Color Filter -->
        <div class="mb-3">
          <label class="form-label text-muted">Color</label>
          <select class="form-select rounded-pill" [(ngModel)]="selectedColor" (change)="applyFilters()">
            <option value="">All</option>
            <option value="Red">Red</option>
            <option value="Black">Black</option>
            <option value="White">White</option>
          </select>
        </div>

        <!-- Category Filter -->
        <div class="mb-3">
          <label class="form-label text-muted">Category</label>
          <select class="form-select rounded-pill" [(ngModel)]="selectedSubCategory" (change)="applyFilters()">
            <option value="">All</option>
            <option value="Sweatshirts">Sweatshirts</option>
            <option value="Shirts">Shirts</option>
            <option value="Trousers">Trousers</option>
            <option value="Jackets">Jackets</option>
            <option value="Vests">Vests</option>
            <option value="Shorts">Shorts</option>
          </select>
        </div>

        <!-- Price Sort -->
        <div>
          <label class="form-label text-muted">Sort by Price</label>
          <select class="form-select rounded-pill" (change)="onSortChange($event)">
            <option value="">Default</option>
            <option value="lowest price">Lowest to Highest</option>
            <option value="highest price">Highest to Lowest</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Product Grid -->
    <div class="col-md-9">
      <div class="row row-cols-2 row-cols-md-3 row-cols-lg-4 g-4" *ngIf="products.length > 0">
        <div class="col" *ngFor="let item of products | search:searchTerm">
          <div class="card h-100 shadow-sm border-0 rounded-4 position-relative">
            <!-- Wishlist Heart Icon -->
            <button
              class="btn btn-light position-absolute top-0 end-0 m-2 p-2 rounded-circle shadow-sm"
              (click)="addToWishlist(item)"
            >
              <i class="bi bi-heart text-danger fs-5"></i>
            </button>

            <!-- Product Image -->
            <div
              class="position-relative cursor-pointer"
              [routerLink]="['/detials', item.productId]"
            >
              <img
                [src]="item.productPicture"
                [alt]="item.productName"
                class="card-img-top rounded-top"
                style="height: 250px; object-fit: contain; background-color: #f8f9fa"
              />
            </div>

            <!-- Card Body -->
            <div class="card-body d-flex flex-column text-center">
              <h6 class="card-title fw-semibold text-dark">{{ item.productName }}</h6>
              <p class="text-muted small">{{ item.description | limitWords: 4 }}</p>

              <div class="product-variants mb-2">
                <div *ngFor="let variant of item.productVariants" class="variant-container">
                  <p class="fw-bold text-primary">{{ variant.price | currency: 'EGP' }}</p>
                </div>
              </div>

              <!-- Add to Cart Button -->
              <div class="mt-auto">
                <a routerLink="/detials/{{item.productId}}">
                <button

                  class="btn btn-outline-primary w-100 rounded-pill"
                >
                  Details
                </button>
              </a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- No Products Found -->
      <div *ngIf="products.length === 0" class="text-center mt-5">
        <p class="text-muted">No products found in this category.</p>
      </div>
    </div>
  </div>
</section>
